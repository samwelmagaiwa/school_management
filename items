{"type":"begin","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"}}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"    public function invoiceIsLocked(Invoice $invoice): bool\n"},"line_number":82,"absolute_offset":2155,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"    {\n"},"line_number":83,"absolute_offset":2215,"submatches":[]}}
{"type":"match","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"        if (! $invoice->academic_period_id) {\n"},"line_number":84,"absolute_offset":2221,"submatches":[{"match":{"text":"invoice-"},"start":15,"end":23}]}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"            return false;\n"},"line_number":85,"absolute_offset":2267,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"        }\n"},"line_number":86,"absolute_offset":2293,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"\n"},"line_number":87,"absolute_offset":2303,"submatches":[]}}
{"type":"match","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"        $period = AcademicPeriod::find($invoice->academic_period_id);\n"},"line_number":88,"absolute_offset":2304,"submatches":[{"match":{"text":"invoice-"},"start":40,"end":48}]}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"        return $period?->is_locked ?? false;\n"},"line_number":89,"absolute_offset":2374,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"lines":{"text":"    }\n"},"line_number":90,"absolute_offset":2419,"submatches":[]}}
{"type":"end","data":{"path":{"text":"app\\Services\\Accounting\\AccountingPermissionService.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":909200,"human":"0.000909s"},"searches":1,"searches_with_match":1,"bytes_searched":3611,"bytes_printed":2105,"matched_lines":2,"matches":2}}}
{"type":"begin","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"}}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"\n"},"line_number":44,"absolute_offset":1624,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            $invoice = Invoice::create($payload);\n"},"line_number":45,"absolute_offset":1625,"submatches":[]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            $invoice->items()->createMany($items);\n"},"line_number":46,"absolute_offset":1675,"submatches":[{"match":{"text":"invoice-"},"start":13,"end":21}]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"\n"},"line_number":47,"absolute_offset":1726,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            return $invoice;\n"},"line_number":48,"absolute_offset":1727,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        });\n"},"line_number":49,"absolute_offset":1756,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"\n"},"line_number":50,"absolute_offset":1768,"submatches":[]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        AccountingSecurityLogger::log('invoice.created', $invoice, ['new' => $invoice->toArray()]);\n"},"line_number":51,"absolute_offset":1769,"submatches":[{"match":{"text":"invoice-"},"start":78,"end":86}]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"\n"},"line_number":52,"absolute_offset":1869,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        return Qs::jsonStoreOk();\n"},"line_number":53,"absolute_offset":1870,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        $notes = $request->input('notes');\n"},"line_number":100,"absolute_offset":3632,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"\n"},"line_number":101,"absolute_offset":3675,"submatches":[]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        $old = $invoice->toArray();\n"},"line_number":102,"absolute_offset":3676,"submatches":[{"match":{"text":"invoice-"},"start":16,"end":24}]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        $invoice->update([\n"},"line_number":103,"absolute_offset":3712,"submatches":[{"match":{"text":"invoice-"},"start":9,"end":17}]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            'discount_total' => $invoice->discount_total + $amount,\n"},"line_number":104,"absolute_offset":3739,"submatches":[{"match":{"text":"invoice-"},"start":33,"end":41}]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            'balance_due' => max(0, $invoice->balance_due - $amount),\n"},"line_number":105,"absolute_offset":3807,"submatches":[{"match":{"text":"invoice-"},"start":37,"end":45}]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        ]);\n"},"line_number":106,"absolute_offset":3877,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"\n"},"line_number":107,"absolute_offset":3889,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        AccountingSecurityLogger::log('invoice.waiver_approved', $invoice, [\n"},"line_number":108,"absolute_offset":3890,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            'old' => $old,\n"},"line_number":109,"absolute_offset":3967,"submatches":[]}}
{"type":"match","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            'new' => $invoice->toArray(),\n"},"line_number":110,"absolute_offset":3994,"submatches":[{"match":{"text":"invoice-"},"start":22,"end":30}]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"            'description' => $notes,\n"},"line_number":111,"absolute_offset":4036,"submatches":[]}}
{"type":"context","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"lines":{"text":"        ]);\n"},"line_number":112,"absolute_offset":4073,"submatches":[]}}
{"type":"end","data":{"path":{"text":"app\\Http\\Controllers\\Accounting\\AccountingActionController.php"},"binary_offset":null,"stats":{"elapsed":{"secs":0,"nanos":141800,"human":"0.000142s"},"searches":1,"searches_with_match":1,"bytes_searched":5094,"bytes_printed":5555,"matched_lines":7,"matches":7}}}
{"data":{"elapsed_total":{"human":"0.175294s","nanos":175293500,"secs":0},"stats":{"bytes_printed":7660,"bytes_searched":8705,"elapsed":{"human":"0.001051s","nanos":1051000,"secs":0},"matched_lines":9,"matches":9,"searches":2,"searches_with_match":2}},"type":"summary"}
